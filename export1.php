<?php$filename        = 'details.xls';$table_name        = 'newsletterform';$hostname = "localhost";$database = "livemysi_xaaza";$username = "livemysi_xaaza";$password = "n8viiA(liqof";$showErrors = true;if($showErrors) { error_reporting(E_ALL);    ini_set('error_reporting', E_ALL);    ini_set('display_errors',1); }function cleanData($str) {     $str = preg_replace("/\t/", " ", $str); // clean out tabs in data - replace with space    $str = preg_replace("/\n/", ", ", $str); // clean out line breaks and replace with comma+space    $str = preg_replace("/\r/", "", $str); // clean out extra line breaks    return $str;} $MJCONN = mysqli_connect($hostname, $username, $password, $database);$query_rsExport = "SELECT n.newsletterformId,n.name,n.email,n.contactno,n.categoryId,c.categoryId,c.categoryName,group_concat(c.categoryName SEPARATOR ',') AS Category_InterestedFROM newsletterform n,category cwhere c.categoryId = n.categoryIdGROUP BY n.name";echo $query_rsExport; exit();$rsExport = mysqli_query($MJCONN,$query_rsExport) or die(mysql_error());$fields = mysqli_fetch_fields($rsExport);$row_rsExport = mysqli_fetch_assoc($rsExport);$totalRows_rsExport = mysqli_num_rows($rsExport);$d = "\t";$nl = "\n";$contents = '';// write out fieldsforeach($fields as $field) {    $contents .= $field->name.$d;}// close fields list$contents .= $nl;// write out datado {    foreach($fields as $field) { // loop through fileds to output        $contents .= cleanData($row_rsExport[$field->name]).$d;    }    // close record line    $contents .= $nl;}while($row_rsExport = mysqli_fetch_assoc($rsExport));// free memorymysqli_free_result($rsExport);// Send Headersheader("Pragma: public");header("Expires: 0");header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); header('Content-type: application/vnd.ms-excel');header('Content-Disposition: attachment; filename='.$filename);echo $contents;exit;?>